---
import type { HTMLAttributes } from "astro/types";
import { cn } from "@bejamas/ui/lib/utils";

type Props = {
  align?: "start" | "center" | "end";
  sideOffset?: number;
  class?: string;
} & HTMLAttributes<"div">;

const {
  align = "start",
  sideOffset = 4,
  class: className = "",
  ...rest
} = Astro.props as Props;

const alignClasses = {
  start: "left-0",
  center: "left-1/2 -translate-x-1/2",
  end: "right-0",
};
---

<!-- Outer: data-slot target for the library (positioning + visibility only) -->
<div
  {...rest}
  data-slot="dropdown-menu-content"
  data-align={align}
  style={`--side-offset: ${sideOffset}px`}
  class={cn(
    "group/dropdown-menu-content",
    "absolute top-full mt-[var(--side-offset)]",
    alignClasses[align],
    "hidden data-[state=open]:block [transition:display_150ms_allow-discrete] starting:data-[state=closed]:block",
    "[--origin-y:top] data-[side=top]:[--origin-y:bottom]",
    "data-[align=start]:[--origin-x:left] data-[align=center]:[--origin-x:center] data-[align=end]:[--origin-x:right]",
  )}
>
  <!-- Inner: visual styling + animations + className override -->
  <div
    class={cn(
      "min-w-32 overflow-hidden rounded-md border border-border bg-popover p-1 text-popover-foreground shadow-md",
      "group-data-[state=open]/dropdown-menu-content:animate-in group-data-[state=closed]/dropdown-menu-content:animate-out",
      "group-data-[state=closed]/dropdown-menu-content:fade-out-0 group-data-[state=open]/dropdown-menu-content:fade-in-0",
      "group-data-[state=closed]/dropdown-menu-content:zoom-out-95 group-data-[state=open]/dropdown-menu-content:zoom-in-95",
      "[transform-origin:var(--origin-x)_var(--origin-y)]",
      "[--tw-animation-fill-mode:both]",
      className,
    )}
  >
    <slot />
  </div>
</div>
