---
import type { HTMLAttributes } from "astro/types";
import { cn } from "@bejamas/ui/lib/utils";
import { cva } from "class-variance-authority";

type Props = {
  side?: "top" | "bottom" | "left" | "right";
  align?: "start" | "center" | "end";
  alignOffset?: number;
  sideOffset?: number;
  class?: string;
} & HTMLAttributes<"div">;

const {
  side = "bottom",
  align = "center",
  sideOffset = 6,
  alignOffset = 0,
  class: className = "",
  ...rest
} = Astro.props as Props;

const contentVariants = cva([
  "z-50 hidden data-[state=open]:block duration-150 ease transition-discrete starting:data-[state=closed]:block outline-hidden",
  "bg-popover text-popover-foreground ring-foreground/10 ring-1",
  "flex w-72 flex-col gap-2.5 rounded-lg p-4 text-sm shadow-md",
  "data-[state=open]:animate-in data-[state=closed]:animate-out",
  "data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
  "data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",
  "data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2",
  "[--origin-x:center] [--origin-y:center]",
  "data-[side=top]:[--origin-y:bottom] data-[side=bottom]:[--origin-y:top]",
  "data-[side=left]:[--origin-x:right] data-[side=right]:[--origin-x:left]",
  "data-[side=top]:data-[align=start]:[--origin-x:left] data-[side=top]:data-[align=center]:[--origin-x:center] data-[side=top]:data-[align=end]:[--origin-x:right] data-[side=bottom]:data-[align=start]:[--origin-x:left] data-[side=bottom]:data-[align=center]:[--origin-x:center] data-[side=bottom]:data-[align=end]:[--origin-x:right]",
  "data-[side=left]:data-[align=start]:[--origin-y:top] data-[side=left]:data-[align=center]:[--origin-y:center] data-[side=left]:data-[align=end]:[--origin-y:bottom] data-[side=right]:data-[align=start]:[--origin-y:top] data-[side=right]:data-[align=center]:[--origin-y:center] data-[side=right]:data-[align=end]:[--origin-y:bottom]",
  "origin-[var(--origin-x)_var(--origin-y)] [--tw-animation-fill-mode:both]",
]);
---

<div
  {...rest}
  data-slot="popover-content"
  data-align={align}
  data-align-offset={alignOffset}
  data-side={side}
  data-side-offset={sideOffset}
  style={`--side-offset: ${sideOffset}px`}
  class={cn(contentVariants(), className)}
>
  <slot />
</div>
