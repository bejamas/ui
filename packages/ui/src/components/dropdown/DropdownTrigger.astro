---
import { cn } from "@bejamas/ui/lib/utils";
import type { HTMLAttributes, HTMLTag } from "astro/types";
import { Button } from "../button";

type Props = {
  as?: HTMLTag;
  class?: string;
} & HTMLAttributes<"button">;

const {
  as: rawTag,
  class: className = "",
  ...rest
} = Astro.props as Props;

const Tag = rawTag ?? undefined;
---

{Tag ? (
  <Tag
    {...rest}
    slot="trigger"
    role="button"
    tabindex="0"
    data-slot="dropdown-trigger"
    class={cn(
      "cursor-pointer select-none outline-none group-focus-within:pointer-events-none inline-flex items-center gap-1",
      className,
    )}
  >
    <slot />
    <svg
      aria-hidden="true"
      viewBox="0 0 20 20"
      fill="currentColor"
      class="ml-1 -mr-1 h-4 w-4 shrink-0 transition-transform duration-150 ease-out group-focus-within:rotate-180 group-has-[:active]:rotate-180"
    >
      <path
        fill-rule="evenodd"
        d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z"
        clip-rule="evenodd"
      />
    </svg>
  </Tag>
) : (
  <Button
    slot="trigger"
    as="div"
    tabindex="0"
    role="button"
    variant="ghost"
    data-slot="dropdown-trigger"
    class={cn(
      "cursor-pointer select-none outline-none group-focus-within:pointer-events-none",
      className,
    )}
    {...(rest as any)}
  >
    <span class="inline-flex items-center gap-1">
      <slot />
      <svg
        aria-hidden="true"
        viewBox="0 0 20 20"
        fill="currentColor"
        class="ml-1 -mr-1 h-4 w-4 shrink-0 transition-transform duration-150 ease-out group-focus-within:rotate-180 group-has-[:active]:rotate-180"
      >
        <path
          fill-rule="evenodd"
          d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z"
          clip-rule="evenodd"
        />
      </svg>
    </span>
  </Button>
)}

