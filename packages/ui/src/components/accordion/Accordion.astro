---
/**
 * @component Accordion
 * @title Accordion
 * @description Vertically stacked collapsible sections that let users show and hide content panels.
 * @figmaUrl https://www.figma.com/design/koxai7zw5vIuBzuVxe5T2l/BejamasUI---Design-System?node-id=2589-14086&t=YFStJ3V8fXEO8QD8-4
 *
 * @preview
 *
 * <Accordion class="w-full max-w-[420px] self-start mt-10" collapsible>
 *   <AccordionItem value="accordion-item-1">
 *     <AccordionTrigger>
 *       Is it accessible?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes. It adheres to WAI-ARIA design patterns.
 *     </AccordionContent>
 *   </AccordionItem>
 *   <AccordionItem value="accordion-item-2">
 *     <AccordionTrigger>
 *       Can I customize the icon?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes you can.
 *     </AccordionContent>
 *   </AccordionItem>
 * </Accordion>
 *
 * @usage
 *
 * ```astro nocollapse
 * ---
 * import { Accordion, AccordionItem, AccordionTrigger, AccordionContent } from '@bejamas/ui/components/accordion';
 * ---
 *
 * <Accordion class="w-full max-w-[420px] self-start">
 *   <AccordionItem open>
 *     <AccordionTrigger>
 *       Is it accessible?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes. It adheres to WAI-ARIA design patterns.
 *     </AccordionContent>
 *   </AccordionItem>
 * </Accordion>
 * ```
 *
 * @api
 *
 * ### Events
 *
 * The accordion emits custom events that you can listen to:
 *
 * | Event | Detail | Description |
 * |-------|--------|-------------|
 * | `accordion:change` | `{ value: string[] }` | Fired when expanded items change |
 *
 * ```astro nocollapse
 * <Accordion id="my-accordion" collapsible>
 *   <AccordionItem value="item-1">
 *     <AccordionTrigger>Item 1</AccordionTrigger>
 *     <AccordionContent>Content 1</AccordionContent>
 *   </AccordionItem>
 * </Accordion>
 *
 * <script>
 *   const accordion = document.getElementById('my-accordion');
 *
 *   accordion.addEventListener('accordion:change', (e) => {
 *     console.log('Expanded items:', e.detail.value);
 *   });
 * </script>
 * ```
 *
 * ### Programmatic Control
 *
 * You can control the accordion programmatically by dispatching an `accordion:set` event:
 *
 * ```js nocollapse
 * const accordion = document.getElementById('my-accordion');
 *
 * // Expand a single item
 * accordion.dispatchEvent(new CustomEvent('accordion:set', {
 *   detail: { value: 'item-1' }
 * }));
 *
 * // Expand multiple items (when multiple prop is true)
 * accordion.dispatchEvent(new CustomEvent('accordion:set', {
 *   detail: { value: ['item-1', 'item-2'] }
 * }));
 * ```
 *
 * ### Data Attributes
 *
 * The accordion sets these data attributes that you can use for styling or querying state:
 *
 * | Attribute | Element | Description |
 * |-----------|---------|-------------|
 * | `data-state` | accordion-item | Current state (`open` or `closed`) |
 *
 * @examples
 *
 * ### Multiple choice accordion
 *
 * <Accordion class="w-full max-w-[420px] self-start" multiple>
 *   <AccordionItem value="accordion-item-1">
 *     <AccordionTrigger>
 *       Is it accessible?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes. It adheres to WAI-ARIA design patterns.
 *     </AccordionContent>
 *   </AccordionItem>
 *   <AccordionItem value="accordion-item-2">
 *     <AccordionTrigger>
 *       Can I customize the icon?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes you can.
 *     </AccordionContent>
 *   </AccordionItem>
 *   <AccordionItem value="accordion-item-3">
 *     <AccordionTrigger>
 *       Can I customize the icon?
 *     </AccordionTrigger>
 *     <AccordionContent>
 *       Yes you can.
 *     </AccordionContent>
 *   </AccordionItem>
 * </Accordion>
 *
 */

import { cn } from "@bejamas/ui/lib/utils";
import type { HTMLAttributes } from "astro/types";

type Props = {
  class?: string;
  multiple?: boolean;
  defaultValue?: string;
  collapsible?: boolean;
} & HTMLAttributes<"div">;

const {
  class: className = "",
  multiple = false,
  defaultValue = "",
  collapsible = false,
  ...rest
} = Astro.props as Props;
---

<div
  {...rest}
  data-slot="accordion"
  data-multiple={multiple}
  data-defaultValue={defaultValue}
  data-collapsible={collapsible}
  class={cn(className)}
>
  <slot />
</div>

<script>
  import { createAccordion } from "@data-slot/accordion";

  document
    .querySelectorAll('[data-slot="accordion"]')
    .forEach((el) => createAccordion(el));
</script>
