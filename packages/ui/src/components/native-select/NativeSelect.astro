---
/**
 * @component NativeSelect
 * @title Native Select
 * @description A styled native HTML select element with consistent design system integration.
 *
 * @preview
 * <NativeSelect class="w-[200px]">
 *   <NativeSelectOption value="">Select a fruit</NativeSelectOption>
 *   <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *   <NativeSelectOption value="banana">Banana</NativeSelectOption>
 *   <NativeSelectOption value="cherry">Cherry</NativeSelectOption>
 * </NativeSelect>
 *
 * @usage
 *
 * ```astro nocollapse
 * ---
 * import {
 *   NativeSelect,
 *   NativeSelectOption,
 *   NativeSelectOptGroup,
 * } from '@bejamas/ui/components/native-select';
 * ---
 *
 * <NativeSelect>
 *   <NativeSelectOption value="">Select a fruit</NativeSelectOption>
 *   <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *   <NativeSelectOption value="banana">Banana</NativeSelectOption>
 * </NativeSelect>
 * ```
 *
 * ### Native Select vs Select
 *
 * Use **NativeSelect** when you need standard browser form behavior â€” native validation, mobile-optimized pickers, and zero JavaScript. Use **Select** when you need a custom-styled dropdown with keyboard navigation, grouped items, and rich content.
 *
 * @examples
 *
 * ### With Groups
 *
 * <NativeSelect class="w-[200px]">
 *   <NativeSelectOptGroup label="Fruits">
 *     <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *     <NativeSelectOption value="banana">Banana</NativeSelectOption>
 *   </NativeSelectOptGroup>
 *   <NativeSelectOptGroup label="Vegetables">
 *     <NativeSelectOption value="carrot">Carrot</NativeSelectOption>
 *     <NativeSelectOption value="broccoli">Broccoli</NativeSelectOption>
 *   </NativeSelectOptGroup>
 * </NativeSelect>
 *
 * ### Sizes
 *
 * <div class="flex flex-col items-start gap-4 sm:flex-row">
 *   <NativeSelect class="w-[180px]" size="sm">
 *     <NativeSelectOption value="">Small (h-8)</NativeSelectOption>
 *     <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *     <NativeSelectOption value="banana">Banana</NativeSelectOption>
 *   </NativeSelect>
 *   <NativeSelect class="w-[180px]" size="default">
 *     <NativeSelectOption value="">Default (h-9)</NativeSelectOption>
 *     <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *     <NativeSelectOption value="banana">Banana</NativeSelectOption>
 *   </NativeSelect>
 *   <NativeSelect class="w-[180px]" size="lg">
 *     <NativeSelectOption value="">Large (h-10)</NativeSelectOption>
 *     <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *     <NativeSelectOption value="banana">Banana</NativeSelectOption>
 *   </NativeSelect>
 * </div>
 *
 * ### Disabled
 *
 * <NativeSelect disabled class="w-[200px]">
 *   <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *   <NativeSelectOption value="banana">Banana</NativeSelectOption>
 * </NativeSelect>
 *
 * ### Invalid
 *
 * <NativeSelect aria-invalid="true" class="w-[200px]">
 *   <NativeSelectOption value="">Select a fruit</NativeSelectOption>
 *   <NativeSelectOption value="apple">Apple</NativeSelectOption>
 *   <NativeSelectOption value="banana">Banana</NativeSelectOption>
 * </NativeSelect>
 *
 */

import type { HTMLAttributes } from "astro/types";
import { cn } from "@bejamas/ui/lib/utils";
import ChevronDownIcon from "@lucide/astro/icons/chevron-down";

type Props = {
  class?: string;
  size?: "sm" | "default" | "lg";
} & HTMLAttributes<"select">;

const {
  class: className = "",
  size = "default",
  ...rest
} = Astro.props as Props;
---

<div
  data-slot="native-select-wrapper"
  data-size={size}
  class={cn(
    "group/native-select relative w-fit has-[select:disabled]:opacity-50",
    className,
  )}
>
  <select
    data-slot="native-select"
    data-size={size}
    class={cn(
      "border-input placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 dark:hover:bg-input/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 w-full min-w-0 appearance-none rounded-lg border bg-transparent py-1 pr-8 pl-2.5 text-sm transition-colors select-none focus-visible:ring-3 aria-invalid:ring-3 outline-none disabled:pointer-events-none disabled:cursor-not-allowed",
      "data-[size=sm]:h-8 data-[size=default]:h-9 data-[size=lg]:h-10",
    )}
    {...rest}
  >
    <slot />
  </select>
  <ChevronDownIcon
    class="text-muted-foreground top-1/2 right-2.5 size-4 -translate-y-1/2 pointer-events-none absolute select-none"
    aria-hidden="true"
    data-slot="native-select-icon"
  />
</div>
